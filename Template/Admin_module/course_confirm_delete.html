{% extends 'Static/base.html' %}
{% load static %}

{% block title %}{{ page_title }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/admin_module.css' %}?v=20251016">
{% endblock %}

{% block content %}
<div class="container">
    <div class="form-container">
        <div class="form-header">
            <h1><i class="fas fa-exclamation-triangle text-warning me-2"></i>{{ page_title }}</h1>
            <p>Please confirm that you want to delete this course</p>
        </div>
        
        <div class="form-body">
            {% if messages %}
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }}">{{ message }}</div>
                {% endfor %}
            {% endif %}

            <div class="alert alert-danger">
                <h4 class="alert-heading"><i class="fas fa-exclamation-triangle me-2"></i>Warning!</h4>
                <p>You are about to delete the course <strong>"{{ course.name }}"</strong>. This action cannot be undone.</p>
                <hr>
                <p class="mb-0"><strong>Course Details:</strong></p>
                <ul class="mb-0">
                    <li><strong>Name:</strong> {{ course.name }}</li>
                    <li><strong>Code:</strong> {{ course.code }}</li>
                    <li><strong>Department:</strong> {{ course.department.name }} ({{ course.department.code }})</li>
                    <li><strong>Students:</strong> {{ course.students.count }} student(s)</li>
                </ul>
            </div>

            {% if course.students.count > 0 %}
            <div class="alert alert-warning">
                <h5><i class="fas fa-info-circle me-2"></i>Cannot Delete Course</h5>
                <p>This course cannot be deleted because it has <strong>{{ course.students.count }}</strong> student(s) assigned to it.</p>
                <p>Please reassign all students to other courses before deleting this course.</p>
            </div>
            {% endif %}

            <form method="post">
                {% csrf_token %}
                <input type="hidden" name="course_id" value="{{ course.id }}">
                
                <div class="d-flex justify-content-end gap-3 mt-4">
                    <a href="{% url 'admin_module:course_management' %}" class="btn-ebotar btn-ebotar-outline">Cancel</a>
                    {% if course.students.count == 0 %}
                    <button type="submit" class="btn-ebotar btn-ebotar-danger">
                        <i class="fas fa-trash me-1"></i>Delete Course
                    </button>
                    {% endif %}
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

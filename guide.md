# E-Botar System Guide

## Scope and Limitations

This section states exactly what the implemented system covers (scope) and what it does not (limitations), aligned with the actual codebase and current deployment model.

### 1) Registration Module (User + Candidate)

- Voter Registration
  - Email/username-based account creation using Django auth.
  - Profile completion required before voting: department, course, year level, optional phone and avatar.
  - Admin verification flag (`is_verified`) acts as the admission gate to voting features.
- Candidate Registration
  - Admin-assisted candidate applications (party, manifesto, photo, target election + position).
  - One application per user per election enforced; duplicate and cross-position checks.
  - Review workflow: admin approves/rejects with audit trail; on approval, an actual `Candidate` record is created.
- Data Quality & Validation
  - Student ID format and autogenerated IDs for verified users without one.
  - Department ↔ Course referential integrity on profile updates.
  - Server-side validation and CSRF on all forms.

### 2) Voting Module

- Secure Login
  - Django session auth; optional Google OAuth (allauth) integration.
  - CSRF tokens on all POST requests; HTTPS assumed at deployment.
- Ballot Discovery & Eligibility
  - The active election is discovered via time window and `is_active` flag (`is_active_now()` checks both).
  - Only verified users can vote; only one ballot per user/election is accepted.
- Ballot UI & Casting
  - Position-wise ballot UI with approved candidates only.
  - Client-side checks (one selection per position) and server-side validation.
  - Atomic submit: creates per-position anonymized votes, returns a receipt code, and stores an encrypted ballot copy.
- Receipts & Verification
  - Unique receipt code recorded in `VoteReceipt` for audit.
  - My Ballot view shows what the user cast; receipt verification endpoint present.

### 3) Candidate Module

- Candidate Profile & Listing
  - Card-style listing per position (party, course/year, avatar when available).
  - Candidate status toggling by admin.
- Management
  - Modal-based quick edit (party, active status).
  - Disqualification/Deletion with required memo; reason stored in audit logs and emailed to candidate.

### 4) Security Module

- Data/Vote Protection
  - Ballot copy encrypted using project secret-derived key (see `E_Botar/services/security`).
  - Separation of concerns: anonymized votes (tally) vs. receipts (audit) vs. encrypted ballots (verification).
- RBAC
  - Staff/Admin-only routes guarded via decorators; sensitive endpoints are POST-only.
- AppSec Controls
  - CSRF protection; session cookies; password hashing (Django defaults).
  - Activity logging on critical actions (login, approvals, voting, admin changes).

### 5) Result Module

- Real-time Aggregation (on request)
  - Counts by candidate/position computed via DB aggregation; no materialized cache required.
  - Winner/highlights in UI; total votes per position displayed.
- Visualization
  - Card-based results for all users; staff-only charts via Chart.js.
  - No WebSockets; refresh to update.

### 6) Admin Module

- Dashboard & Monitoring
  - KPIs: users, elections, votes, applications status; quick navigation.
- Elections Management
  - Create/Edit election using start/end year (auto-computed title: `SY YYYY-YYYY`).
  - Controls: Pause (sets `is_active=False`), Resume (sets `is_active=True`), End Now (sets `end_date=now` and deactivates).
  - Positions management with drag-and-drop order; associate to active election.
- Candidate Management
  - Table with modal-based Quick Edit & Delete (with memo); filtered search (course/year/position/party).
- Academic Data
  - Departments/Courses CRUD; CSV import/export; reassignment logic.
- Users & Bulk Ops
  - Admin user tools for importing/exporting users; bulk user generation with realistic test data.
- Analytics (staff-only)
  - Participation views by department and course.

### Cross-cutting Behavior & UX

- Modal-based interactions for common edits to reduce page navigation.
- POST-only destructive actions without exposing IDs in the URL (IDs passed in the body).
- Consistent error and success messaging; graceful fallbacks in case of email send errors.
- Pagination for list-heavy admin views.

---

## Limitations (Current Version)

### Functional Limits

- Real-time updates are pull-based; no push/WebSocket streaming for live tallies.
- Receipt verification shows a user’s ballot details, but there is no public bulletin board or external audit proofs.
- No voter self-service registration flows for candidates; applications are admin-assisted by design.
- Election edits post-launch are allowed to admins; operational discipline is required to prevent mid-election changes.

### Security & Privacy Boundaries

- Encryption uses app secret; proper key rotation and KMS integration are not included.
- No MFA for admins by default; rely on strong passwords and HTTPS-only deployments.
- Email delivery is best-effort; if SMTP is misconfigured, notifications may be delayed or fail.

### Performance & Availability

- Single-DB, single-app instance architecture; horizontal scaling and read replicas are not configured.
- On-demand aggregation scales to typical school workloads; extreme concurrency may require DB indexes/tuning or caching.
- File upload size and email rate depend on hosting provider limits.

### Operations & Data Lifecycle

- Backups, archival, and retention policies are manual/ops-runbook driven.
- Limited built-in exports (users/departments/courses). Results export is not yet automated.
- Timezone handling relies on server settings; UI displays as configured; no per-user timezone UI yet.

### Platform & Client Support

- Modern evergreen browsers (Chrome/Edge/Firefox/Safari). IE is not supported.
- Mobile-responsive UI for core flows; heavy admin tables are best on desktop.

---

## Out of Scope (Explicit)

- End-to-end verifiable cryptographic voting (ZKPs, mixnets) – not implemented.
- SMS/Push notifications – email only.
- Multi-tenant instances or federated schools – single-institution instance.
- Fully automated incident response and SIEM integration.

---

## Assumptions & Preconditions

- An admin seeds or imports departments/courses and verifies eligible users.
- SMTP is configured for email notifications; HTTPS is enforced at the reverse proxy.
- Election windows are defined correctly; admins use Pause/Resume/End controls responsibly.

---

## Non‑Functional Expectations (Target)

- Usability: modal-first quick actions; clear error copy; accessible contrasts.
- Performance: 95th-percentile page load < 2.5s on broadband; results query returns < 1s for typical loads.
- Reliability: all write operations are ACID via relational DB; user-visible confirmations for critical tasks.
- Security: CSRF protected; least-privilege admin; auditable actions retained in `ActivityLog`.

---

## Future Enhancements (Recommended)

- WebSocket live results and admin dashboards.
- Role granularity (e.g., Election Manager vs. Data Admin) and optional MFA.
- Results export (CSV/JSON) and printable certificates of canvass.
- Distributed cache for counts during peak hours; background tasks for email and heavy analytics.
- Key management refactor to support external KMS and rotation.

Complete guidelines and tutorials on how to use the E-Botar Electronic Voting System.

---

## Table of Contents

1. [System Overview](#system-overview)
2. [Quick Start Guide](#quick-start-guide)
3. [User Guides](#user-guides)
4. [Administrator Guide](#administrator-guide)
5. [Technical Documentation](#technical-documentation)
6. [Security Features](#security-features)
7. [Database Schema](#database-schema)
8. [Troubleshooting](#troubleshooting)
9. [API Reference](#api-reference)
10. [Development Guide](#development-guide)

---

## System Overview

**E-Botar** is a comprehensive electronic voting system designed for student government elections. The system provides a secure, transparent, and user-friendly platform for conducting school-wide elections.

### Key Information
- **Project Name**: E-Botar (Electronic Voting System)
- **Version**: 20.0 (Breakthrough)
- **Framework**: Django 4.2+
- **Database**: SQLite (Development) / PostgreSQL (Production Ready)
- **Frontend**: Bootstrap 5 + Custom CSS
- **Language**: Python 3.8+

### Purpose
- Facilitate democratic student government elections
- Provide transparent voting and results
- Manage candidate applications and approvals
- Track election statistics and activities
- Ensure secure and verifiable voting process

---

## Quick Start Guide

### Prerequisites
- Python 3.8 or higher
- pip (Python package installer)
- Virtual environment (recommended)

### 1. Navigate to Project
```powershell
cd "D:\Downloads_D\Project Thesis\E_Botar"
```

### 2. Activate Virtual Environment
```powershell
# Windows PowerShell
.\venv\Scripts\Activate.ps1

# Or use the batch file
.\start_server.bat
```

### 3. Install Dependencies (First Time Only)
```powershell
pip install -r requirements.txt
```

### 4. Setup Database (First Time Only)
```powershell
python manage.py migrate
python manage.py createsuperuser
```

### 5. Run Server
```powershell
python manage.py runserver
```

### 6. Access Application
- **Main Application**: http://127.0.0.1:8000/
- **Custom Admin**: http://127.0.0.1:8000/admin-ui/
- **Django Admin**: http://127.0.0.1:8000/admin/

---

## User Guides

### For Students

#### 1. **Registration**
1. Navigate to home page
2. Click "Register" in menu
3. Fill in registration form:
   - Username (unique)
   - Email address
   - First and Last Name
   - Password (confirm)
4. Click "Register"
5. Log in with credentials

#### 2. **Complete Profile**
1. Click "Profile" in menu
2. Fill in required information:
   - **Student ID**: Format XXXX-XXXXX (e.g., 2024-12345)
   - **Department**: Select from dropdown
   - **Course**: Select from dropdown
   - **Year Level**: Enter (e.g., "3rd Year")
   - **Phone Number** (optional)
   - **Avatar**: Upload profile photo
3. Click "Update Profile"

#### 3. **View Elections**
1. Click "Election" in menu
2. Browse available elections
3. View election details:
   - Title and description
   - Start and end dates
   - Vote count
   - Status (Active/Upcoming/Ended)

#### 4. **Cast Vote**
1. Navigate to active election
2. Click "Vote Now"
3. For each position:
   - View candidates (photo, name, course, manifesto)
   - Select one candidate per position
   - Click candidate card to select
4. Review selections
5. Click "Submit Vote"
6. Confirm submission
7. View confirmation message

**Important:**
- Can only vote once per election
- Cannot change vote after submission
- All positions must be filled

#### 5. **View Results**
1. Click "Previous Election" in menu
2. Select completed election
3. View results:
   - Vote counts per candidate
   - Percentages
   - Winner indicated with crown icon
   - Charts (if logged in as admin)

#### 6. **Apply as Candidate**
1. Click "Apply as Candidate" in menu
   - (Only available if upcoming elections exist)
2. Review requirements
3. Fill application form:
   - **Position**: Select desired position
   - **Election**: Select upcoming election
   - **Party**: Optional (registered or custom)
   - **Manifesto**: Your platform and goals
   - **Photo**: Upload or use profile picture
4. Click "Submit Application"
5. Track status in "My Applications"

#### 7. **Track Applications**
1. Click "My Applications" in menu
2. View all applications with status:
   - **Pending**: Under review
   - **Approved**: Accepted as candidate
   - **Rejected**: Not approved (see reason)
   - **Withdrawn**: Canceled by you
3. Actions available:
   - Withdraw pending applications
   - Delete rejected applications
   - View election details

#### 8. **Candidate Dashboard**
1. Click "Candidate Dashboard" in menu
2. View statistics:
   - Active candidacies count
   - Total applications
   - Votes received
   - Elections participated
3. See active candidacies with:
   - Vote counts
   - Percentages
   - Progress bars
4. Quick actions available

---

## Administrator Guide

### 1. **Access Admin Panel**
1. Log in as staff/superuser
2. Click "Admin" in menu
3. Access admin dashboard

### 2. **User Management**

**View Users:**
1. Admin Dashboard → Users section
2. Search, filter by role/status
3. Pagination for large lists

**Create User:**
1. Click "Create New User"
2. Fill form:
   - Username, email, name
   - Staff/Active checkboxes
   - Confirm admin password
3. System generates random password
4. Copy password for user

**Edit User:**
1. Click username in list
2. Update information
3. Manage profile:
   - Student ID
   - Department/Course
   - Verification status
4. Save changes

**Bulk Import:**
1. Admin Dashboard → "Import Users"
2. Upload CSV/Excel file with columns:
   - username, email, first_name, last_name
3. System creates users with random passwords
4. Export results

**Reset Password:**
1. User detail page
2. Click "Reset Password"
3. Enter admin password
4. View generated password
5. Provide to user

### 3. **Election Management**

**Create Election:**
1. Admin → "Elections" → "Create Election"
2. Fill form:
   - **Start Year**: e.g., 2025
   - **End Year**: e.g., 2026
   - **Description**: Brief description
   - **Start Date/Time**: When voting begins
   - **End Date/Time**: When voting ends
   - **Is Active**: Enable election
3. Title auto-generated: "SY 2025 - 2026 Student Government Election"
4. Save election

**Add Positions to Election:**
1. Election detail page
2. "Add Position" button
3. Select positions from list
4. Set vote limits per position
5. Save configuration

**Edit Election:**
1. Elections list → Click election
2. Modify dates, description, status
3. Add/remove positions
4. Save changes

**View Election Results:**
1. Elections list → View results
2. See vote counts and percentages
3. Export data if needed

### 4. **Position Management**

**Create Position:**
1. Admin → "Positions" → "Create Position"
2. Fill form:
   - **Title**: e.g., "President"
   - **Position Type**: Select type
   - **Department**: Optional (for dept-specific)
   - **Description**: Role description
   - **Is Active**: Enable position
3. Display order auto-assigned
4. Save position

**Reorder Positions:**
1. Positions list page
2. Drag and drop to reorder
3. Order auto-saves

**Edit Position:**
1. Positions list → Click position
2. Update information
3. Save changes

### 5. **Candidate Application Review**

**View Pending Applications:**
1. Click "Review Applications" in menu
2. See statistics:
   - Total pending
   - By position
   - Today's applications
3. Review guidelines displayed

**Review Application:**
1. View applicant details:
   - Photo, name, email
   - Position and election
   - Party affiliation
   - Manifesto
2. Check for:
   - Rule violations (auto-detected)
   - Qualifications
   - Completeness

**Approve Application:**
1. Click "Approve Application"
2. Confirm action
3. System creates candidate record
4. Rules checked:
   - Party uniqueness per position
   - Consecutive term limits
5. Applicant notified

**Reject Application:**
1. Click "Reject Application"
2. Modal appears
3. Enter rejection reason (optional)
4. Confirm rejection
5. Applicant can view reason

### 6. **Candidate Management**

**View All Candidates:**
1. Click "Manage Candidates" in menu
2. Filter by:
   - Search (name, course, year)
   - Position
3. View table with:
   - Name, position, course/year
   - Status (Active/Inactive)
   - Actions

**Create Candidate Manually:**
1. Click "New Candidate"
2. Fill form:
   - Personal information
   - Position and election
   - Party details
   - Photo and manifesto
3. Save candidate

**Edit Candidate:**
1. Candidates list → Click "Edit"
2. Update information
3. Change photo if needed
4. Save changes

**Delete Candidate:**
1. Candidates list → Click "Delete"
2. Confirm deletion
3. Candidate removed (votes preserved)

### 7. **Department & Course Management**

**Create Department:**
1. Admin Dashboard → Departments
2. Click "Create Department"
3. Fill form:
   - Name (e.g., "Computer Science")
   - Code (e.g., "CS")
   - Description
   - Is Active
4. Save department

**Create Course:**
1. Admin Dashboard → Courses
2. Click "Create Course"
3. Fill form:
   - Department (select)
   - Name (e.g., "Bachelor of Science in CS")
   - Code (e.g., "BSCS")
   - Description
   - Is Active
4. Save course

### 8. **Party Management**

**Create Party:**
1. Admin → Parties → "Create Party"
2. Fill form:
   - Party Name
   - Abbreviation
   - Description
   - Logo upload
   - Is Active
3. Save party

**Edit Party:**
1. Parties list → Click party
2. Update information
3. Change logo if needed
4. Save changes

### 9. **Activity Logs**

**View Logs:**
1. Click "Activity Logs" in menu
2. See all system activities:
   - User actions
   - Admin actions
   - Timestamps
   - IP addresses
3. Filter and search
4. Export logs for auditing

### 10. **Export Data**

**Export Users:**
1. Admin Dashboard
2. Click "Export Users"
3. Select fields to export
4. Download CSV file

**Export Election Results:**
1. Election results page
2. Click "Export Results"
3. Download CSV/PDF

---

## Technical Documentation

### System Architecture

The system is organized into 7 core modules:

```
E_Botar/
├── auth_module/          # User authentication & profiles
├── voting_module/        # Core voting functionality
├── candidate_module/     # Candidate applications & management
├── election_module/      # Election configuration & management
├── admin_module/         # Administrative functions
├── security_module/      # Security monitoring & logging
├── result_module/        # Results display & analytics
├── E_Botar/             # Project settings & configuration
│   ├── services/        # Consolidated services
│   ├── utils/           # Consolidated utilities
│   └── management/      # Consolidated management commands
├── Template/            # HTML templates organized by module
├── static/              # CSS, JS, images organized by module
└── media/               # User uploads
```

### Key Models
- **User & UserProfile**: Student accounts with academic information
- **SchoolElection**: Election periods with scheduling
- **SchoolPosition**: Available positions (President, VP, etc.)
- **Candidate**: Approved candidates with party affiliation
- **CandidateApplication**: Application workflow and review
- **VoteReceipt**: Privacy-preserving vote receipts
- **EncryptedBallot**: Personal ballot copies for verification
- **AnonVote**: Anonymous vote records for tallying
- **ActivityLog**: Comprehensive audit trail

---

## Security Features

### Authentication & Authorization
- ✅ Django authentication & authorization
- ✅ Google OAuth 2.0 integration
- ✅ CSRF protection on all forms
- ✅ Password hashing (PBKDF2)
- ✅ Session management with timeout

### Vote Security
- ✅ Multi-layer vote encryption
- ✅ Anonymous vote tallying
- ✅ Encrypted vote receipts
- ✅ One-vote-per-position enforcement (DB constraint)
- ✅ Personal ballot verification system

### Data Protection
- ✅ SQL injection prevention (ORM-based queries)
- ✅ XSS protection (template auto-escaping)
- ✅ Secure file uploads with validation
- ✅ Activity logging for audit trails
- ✅ Data integrity constraints

---

## Database Schema

### Privacy-Preserving Design
The system implements a privacy-preserving voting architecture:

- **VoteReceipt**: Proves user voted without revealing choices
- **EncryptedBallot**: Personal ballot copy for verification
- **AnonVote**: Anonymous vote records for tallying
- **ActivityLog**: Complete audit trail

### Key Relationships
- Users have profiles with academic information
- Elections contain multiple positions
- Candidates run for specific positions in elections
- Votes are encrypted and anonymized for privacy
- All actions are logged for audit purposes

---

## Troubleshooting

### Common Issues

**Server won't start?**
```powershell
# Make sure virtual environment is activated
.\venv\Scripts\Activate.ps1
```

**Cannot apply as candidate?**
- Check if there are upcoming elections (Admin → Create Election with future start date)

**Student ID format error?**
- Use format: XXXX-XXXXX (e.g., 2024-12345)

**Google OAuth not working?**
- Check Google Cloud Console configuration
- Verify redirect URIs match exactly

**Static files not loading?**
```powershell
python manage.py collectstatic --noinput
```

**Database errors?**
```powershell
python manage.py migrate
```

**Permission denied?**
```python
# Make user staff
python manage.py shell
>>> from django.contrib.auth.models import User
>>> user = User.objects.get(username='username')
>>> user.is_staff = True
>>> user.save()
```

---

## API Reference

### Internal Functions

#### Election Utilities
```python
# Check if election is active
election.is_active_now()  # Returns boolean

# Get total votes
election.total_votes()  # Returns integer

# Get election status
if now < election.start_date:
    status = "Upcoming"
elif now > election.end_date:
    status = "Ended"
else:
    status = "Active"
```

#### Candidate Utilities
```python
# Get vote count
candidate.vote_count()  # Returns integer

# Get percentage
candidate.percentage()  # Returns float

# Check if can apply
from django.utils import timezone
upcoming = SchoolElection.objects.filter(
    is_active=True,
    start_date__gt=timezone.now()
).exists()
```

#### Vote Utilities
```python
# Check if user has voted
has_voted = SchoolVote.objects.filter(
    user=user,
    election=election,
    position=position
).exists()

# Submit vote
vote = SchoolVote.objects.create(
    user=user,
    election=election,
    position=position,
    candidate=candidate,
    encrypted_vote=encrypt_vote_data(data)
)
```

---

## Development Guide

### Making Changes
1. Modify models in appropriate module
2. Create migrations: `python manage.py makemigrations`
3. Apply migrations: `python manage.py migrate`
4. Test changes in browser

### Adding New Features
1. Add views in appropriate module
2. Update URLs in module's `urls.py`
3. Create templates in `Template/[module]/`
4. Update forms if needed

### Testing
1. Run system check: `python manage.py check`
2. Test in browser
3. Check admin panel functionality
4. Verify voting process works

### Production Deployment

#### Security Checklist
- [ ] Set `DEBUG = False` in settings.py
- [ ] Change `SECRET_KEY`
- [ ] Configure `ALLOWED_HOSTS`
- [ ] Use HTTPS/SSL
- [ ] Set up proper database (PostgreSQL recommended)
- [ ] Configure static file serving
- [ ] Set up logging

#### Environment Variables
```bash
export SECRET_KEY="your-secret-key-here"
export DEBUG=False
export ALLOWED_HOSTS="yourdomain.com,www.yourdomain.com"
export DATABASE_URL="postgresql://user:password@host:port/dbname"
```

---

## Support

For questions or issues:
1. **Read the documentation** - This guide
2. **Check troubleshooting** - Common issues and solutions
3. **Review activity logs** - Admin panel for system events
4. **Contact system administrator** - For technical support

---

## Acknowledgments

- **Django Framework** - Python web framework
- **Bootstrap 5** - Responsive CSS framework
- **Font Awesome** - Icon library
- **Chart.js** - Data visualization
- **Google OAuth** - Authentication service
- **Thesis advisors** - Guidance and support

---

**E-Botar v20.0 (Breakthrough)** | Last Updated: January 2025  
**Status**: Production Ready | **Architecture**: Modular Design
